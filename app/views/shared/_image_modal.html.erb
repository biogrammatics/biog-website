<!-- Image Modal -->
<div id="<%= modal_id %>" class="hidden fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <!-- Background overlay -->
  <div class="fixed inset-0 bg-black bg-opacity-75 transition-opacity" onclick="document.getElementById('<%= modal_id %>').classList.add('hidden')"></div>

  <!-- Modal panel -->
  <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0">
    <div class="relative inline-block align-middle bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:max-w-6xl sm:w-full">
      <!-- Modal header -->
      <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-charcoal" id="modal-title">
          <%= title %>
        </h3>
        <button type="button" onclick="document.getElementById('<%= modal_id %>').classList.add('hidden')" class="text-gray-400 hover:text-gray-600 transition-colors">
          <i class="bi bi-x-lg text-xl"></i>
        </button>
      </div>

      <!-- Modal body -->
      <div class="bg-white px-6 py-6">
        <div class="text-center">
          <%= image_tag image_url,
                        class: "max-w-full h-auto mx-auto",
                        alt: title,
                        loading: "lazy" %>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-between">
        <button type="button" onclick="document.getElementById('<%= modal_id %>').classList.add('hidden')" class="px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-100 transition-colors">
          Close
        </button>
        <% if download_url.present? %>
          <%= link_to download_url, class: "inline-flex items-center gap-2 px-4 py-2 bg-bio-green text-white font-medium rounded-lg hover:bg-bio-green-dark transition-colors" do %>
            <i class="bi bi-download"></i>
            Download Full Resolution
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
// Close modal on Escape key
document.addEventListener('keydown', function(event) {
  if (event.key === 'Escape') {
    document.getElementById('<%= modal_id %>').classList.add('hidden');
  }
});
</script>
